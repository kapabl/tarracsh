package(default_visibility = ["//visibility:public"])

COMMON_COPTS = [
    "-std=c++20",
    "-DPROJECT_SOURCE_DIR=\\\"__main__\\\"",
]

COMMON_DEPS = [
    "//src/app:app_lib",
    "//src/app/commands:app_commands_lib",
    "//src/app/server:app_server_lib_core",
    "//src/app/server/digest:digest_lib",
    "//src/interfaces/tarracsh:tarracsh_cli_lib",
    "//test/src/app:runtime_test_lib",
    "//:vcpkg_runtime_libs",
    "//:vcpkg_gtest_main",
]

cc_test(
    name = "call_graph_command_tests",
    srcs = ["CallGraphCommandTests.cpp"],
    copts = COMMON_COPTS,
    linkstatic = True,
    deps = COMMON_DEPS,
)

cc_test(
    name = "db_based_command_tests",
    srcs = ["DbBasedCommandTests.cpp"],
    copts = COMMON_COPTS,
    linkstatic = True,
    deps = COMMON_DEPS,
)

cc_test(
    name = "public_digest_command_tests",
    srcs = ["PublicDigestTests.cpp"],
    copts = COMMON_COPTS,
    linkstatic = True,
    data = ["//test-subjects:all"],
    deps = COMMON_DEPS,
)

cc_test(
    name = "query_command_tests",
    srcs = ["QueryCommandTests.cpp"],
    copts = COMMON_COPTS,
    linkstatic = True,
    deps = COMMON_DEPS,
)

cc_test(
    name = "digest_analyzer_tests",
    srcs = ["DigestAnalyzerTests.cpp"],
    copts = COMMON_COPTS,
    linkstatic = True,
    data = ["//test-subjects:all"],
    deps = COMMON_DEPS,
)
